#ADD: MACRO D, A1, A2
 PSHA
 LDAA A1
 ADDA A2
 STAA D
 PULA
#ENDM

#SUB: MACRO D, A1, A2
 PSHA
 LDAA A1
 SUBA A2
 STAA D
 PULA
#ENDM

#MULT: MACRO D, A1, P
 PSHA
 PSHB
 LDAA A1
 LDAB P
MULT ASLA
 SUBB #1
 BNE MULT
 STAA D
 PULB
 PULA
#ENDM

#DIV: MACRO D, A1, P
 PSHA
 PSHB
 LDAA A1
 LDAB P
DIV ASRA
 DECB
 BNE DIV
 STAA D
 PULB
 PULA
#ENDM

#REM: MACRO D, A1, P
 PSHA
 PSHB
 LDAA #1
 LDAB P
 DECB
REM ASLA
 INCA
 DECB
 BNE REM
 ANDA A1
 STAA D
 PULB
 PULA
#ENDM

 PROG
 LDAA #3
#MULT $50,$75,$100
#ADD $100,$200,$500
 INCA
#if ($2='x') REM $300,$400,$500
 STAA $500
 END 